/* Custom Scrollbar Styles */
/* Theme-aware using CSS variables */
.messages::-webkit-scrollbar, .sidebar::-webkit-scrollbar, .content::-webkit-scrollbar {
	width: 10px;
	background: var(--scrollbar-bg);
}
.messages::-webkit-scrollbar-thumb, .sidebar::-webkit-scrollbar-thumb, .content::-webkit-scrollbar-thumb {
	background: var(--scrollbar-thumb);
	border-radius: 8px;
	border: 2px solid var(--scrollbar-bg);
}
.messages::-webkit-scrollbar-thumb:hover, .sidebar::-webkit-scrollbar-thumb:hover, .content::-webkit-scrollbar-thumb:hover {
	background: var(--scrollbar-thumb-hover, var(--scrollbar-thumb));
}
/* Firefox */
.messages, .sidebar, .content {
	scrollbar-width: thin;
	scrollbar-color: var(--scrollbar-thumb) var(--scrollbar-bg);
}
:root {
	--sidebar-width: 350px;
	--topbar-height: 56px;
	--gap: 12px;
	--radius: 12px;
	--content-max: 1000px; /* shared max width for messages + input */

	/* Fonts */
	--font-ui: Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
	--font-accent: "Plus Jakarta Sans", Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;

	/* Light mode defaults (overridden by JS when toggled) */
	--bg: #FFFFFF;                 /* Background (main) */
	--container-bg: #f8f8f8;       /* Chat container background */
	--sidebar-bg: #F3F4F6;         /* Sidebar background */
	--sidebar-text: #111827;       /* Sidebar text */
	--panel: var(--sidebar-bg);    /* Back-compat */
	--text: #111827;               /* Neutral text */
	--text-secondary: #6B7280;     /* Secondary text */
	--accent-primary: #2563EB;     /* Primary Accent */
	--accent-primary-hover: #1D4ED8; /* Darker primary on hover */
	--accent-secondary: #9333EA;   /* Secondary Accent */
	--border: #D1D5DB;             /* Borders / dividers */
	--bubble-user-bg: var(--accent-primary);
	--bubble-user-text: #FFFFFF;
	--bubble-bot-bg: #E5E7EB;      /* Bot messages */
	--bubble-bot-text: #111827;
	--accent-primary-10: rgba(37, 99, 235, 0.1); /* Selected chat */
	--input-bg: #FFFFFF;           /* Input area */
	--input-border: #D1D5DB;
	--sidebar-card-bg: #FFFFFF;    /* Sidebar cards */
	--sidebar-card-bg-hover: #F3F4F6;
	/* Scrollbar variables (light defaults) */
	--scrollbar-thumb: #D1D5DB;
	--scrollbar-thumb-hover: #BFC6D1;
	--scrollbar-bg: var(--container-bg);
	/* Sidebar shadow (light default) */
	--sidebar-shadow: 4px 0 8px rgba(0,0,0,0.05);
	/* Settings panel background */
	--settings-bg: #fff;
}

* { box-sizing: border-box; }
html, body { height: 100%; }
body {
	margin: 0;
	font-family: var(--font-ui);
	color: var(--text);
	background: var(--bg);
	-webkit-font-smoothing: antialiased;
	-moz-osx-font-smoothing: grayscale;
}

/* Top bar */
.topbar {
	position: fixed;
	inset: 0 0 auto 0;
	height: var(--topbar-height);
	display: flex;
	align-items: center;
	gap: 12px;
	padding: 0 12px;
	background: transparent;
	z-index: 35; /* above sidebar */
}
.title { font-size: 16px; font-weight: 600; margin: 0; }
.user-logo {
	background: var(--sidebar-card-bg);
	color: var(--sidebar-text);
	border: 1px solid var(--border); /* subtle grey outline */
	width: 56px; height: 56px; /* bigger button */
	display: grid; place-items: center;
	border-radius: 16px; /* more rounded */
	cursor: pointer;
	font-size: 18px;
	z-index: 40; /* above sidebar */
	position: relative;
	margin-top: 12px;
	transition: background 0.2s, color 0.2s;
}
 .user-logo img {
	width: 34px !important;
	height: 34px !important;
	display: block;
	filter: none;
	transition: none !important;
}
.user-logo:hover { background: var(--sidebar-card-bg); }
/* Scale the icon inside the top-left user button */
.user-logo img { width: 34px !important; height: 34px !important; display: block; }
.user-logo img { width: 34px !important; height: 34px !important; display: block; filter: none; }
/* SVG color for theme (if using inline SVG) */
.user-logo svg { color: var(--sidebar-text); }


/* Sidebar */
.sidebar {
	position: fixed;
	top: 0; /* cover entire vertical length, including the topbar area */
	left: 0;
	width: var(--sidebar-width);
	bottom: 0;
	background: var(--sidebar-bg);
	border-right: none;
	box-shadow: var(--sidebar-shadow);
	transform: translateX(-100%);
	transition: transform 240ms ease;
	z-index: 30;
	display: flex; flex-direction: column;
	overflow-y: auto; /* make sidebar scrollable when content exceeds viewport */
}
.sidebar.open { transform: translateX(0); }
.sidebar-header {
	padding: 20px 70px;
	border-bottom: none;
	font-weight: 1000;
	display: flex;
	align-items: center;
	justify-content: space-between; /* space title and button */
	gap: 10px;
    font-size: 1.75rem;
	font-family: var(--font-accent);
	position: sticky; /* keep title visible */
	top: 0;
	z-index: 65; /* above list items but below topbar */
	background: var(--sidebar-bg);
}
.sidebar-header span {
	margin-left: 8px;
	font-weight: 600;
	color: var(--sidebar-text);
}
.new-chat-btn {
	background: var(--accent-primary);
	color: #fff;
	text-decoration: none;
	border-radius: 10px;
	padding: 8px 12px;
	font-weight: 600;
	font-size: 0.9rem;
	border: 1px solid transparent;
	transition: background 0.2s ease, transform 0.05s ease;
}
.new-chat-btn:hover { background: var(--accent-primary-hover); }
.new-chat-btn:active { transform: translateY(1px); }
.sidebar-content { padding: 8px; display: grid; gap: 6px; }
.sidebar-link {
	color: var(--text);
	text-decoration: none;
	padding: 10px 12px;
	border-radius: 8px;
	border: none;
}
.sidebar-link:hover { background: #0e1520; }

.user-list {
	padding: 8px;
	display: grid;
	gap: 0.75rem; /* taller spacing to match taller cards */
	margin-top: 12px; /* move list up slightly */
}
.user-card {
	display: flex;
	align-items: center;
	gap: 0.75rem; /* slight increase */
	padding: 0.9rem 0.9rem; /* taller card */
	border-radius: 12px; /* slightly smaller radius */
	border: 1px solid var(--border);
	background: var(--sidebar-card-bg);
	color: var(--sidebar-text);
	cursor: pointer;
}
.user-card:hover { background: var(--sidebar-card-bg-hover); }
.user-card.selected { background: var(--accent-primary-10); }
.user-avatar {
	width: 32px; height: 32px; /* a bit bigger to fit taller card */
	display: grid; place-items: center;
	border-radius: 50%;
	background: transparent;
	padding: 0;
}
.user-avatar-img {
	width: 26px;
	height: 26px;
	display: block;
	object-fit: contain;
}
.user-name { font-weight: 600; font-size: 0.95rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; min-width: 0; }

/* History section */
.history-section {
	padding: 8px 12px 16px;
}
.history-header {
	margin: 12px 0 6px;
	font-weight: 700;
	color: var(--sidebar-text);
}
.history-list {
	display: grid;
	grid-template-columns: 1fr; /* single column like user-cards */
	gap: 6px;
	padding: 4px 0;
}
.history-item {
	display: flex;
	justify-content: space-between;
	align-items: center;
	gap: 10px;
	padding: 10px 12px; /* taller entries */
	border-radius: 8px;
	cursor: pointer;
}
.history-item:hover { background: var(--sidebar-card-bg-hover); }
.history-meta { color: var(--text-secondary); font-size: 12px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.history-name { font-size: 13px; font-weight: 600; color: var(--sidebar-text); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
/* Ensure flex children can actually ellipsize */
.history-item > .user-avatar + div { min-width: 0; flex: 1 1 auto; }
.history-info { min-width: 0; flex: 1 1 auto; }
/* New Chat card styling */
.history-new-chat {
	border-style: dashed;
	border-color: var(--accent-primary);
}
.history-new-chat .user-avatar {
	background: var(--accent-primary-10);
	color: var(--accent-primary);
	font-weight: 900;
	font-size: 20px;
}
/* Our history cards reuse .user-card; ensure inner info can shrink so name/meta ellipsize */
.history-card > .user-avatar + div { min-width: 0; flex: 1 1 auto; }
.history-card { overflow: hidden; }
/* Removed history-preview box to simplify UI */

/* Sidebar footer with gear */
.sidebar-footer {
	margin-top: auto;
	position: sticky; /* keep footer visible while scrolling */
	bottom: 0;
	z-index: 60; /* above history/content within sidebar */
	padding: 10px 12px;
	display: flex;
	justify-content: flex-start; /* bottom-left */
}
 .settings-panel {
	position: relative;
	z-index: 70; /* ensure panel and buttons overlay list items */
	display: flex;
	align-items: center;
	gap: 14px; /* more gap, room for future buttons */
	background: var(--settings-bg);
	color: var(--sidebar-text);
	border-radius: 16px; /* more rounded */
	border: 1px solid var(--border); /* subtle grey outline */
	height: 56px; /* match user button height for parity */
	padding: 10px 12px;
	overflow: hidden; /* hide buttons until expanded */
	width: 56px; /* collapsed width equals gear */
	transition: width 240ms ease, background 200ms ease;
}
.settings-panel.open {
	width: calc(100% - 24px); /* expand across available space */
}
 .settings-item {
	width: 56px;
	height: 56px;
	border-radius: 16px; /* more rounded */
	border: none;
	background: transparent; /* transparent so the whole bar reads as one white piece */
	color: var(--sidebar-text);
	cursor: pointer;
	flex: 0 0 auto;
	display: grid;
	place-items: center;
	transition: background 0.2s, color 0.2s, filter 0.2s;
}
.settings-item:hover { background: transparent; }
.gear-item {
	background: transparent;
	color: var(--sidebar-text);
	font-size: 20px;
	margin-left: 0; /* center gear within squared panel */
}
.gear-item img {
	margin-left: -25px;
	transition: transform 0.3s cubic-bezier(.4,2,.6,1);
}
.gear-item.rotated img {
	transform: rotate(60deg);
}
.gear-item.unrotated img {
	transform: rotate(-60deg);
}
.settings-item img { width: 34px; height: 34px; display: block; }
.placeholder-dot { width: 14px; height: 14px; background: #4b5563; border-radius: 50%; display: block; }

/* Content */
.content {
	position: fixed;
	top: var(--topbar-height);
	left: 0; right: 0;
	bottom: 72px; /* reserved for input bar */
	overflow: auto;
	padding: 2rem; /* more breathing room */
	background: var(--container-bg);
	transition: left 240ms ease;
}
.messages {
	display: grid;
	/* remove automatic grid gap so we can control spacing per-message for clearer grouping */
	gap: 0;
	width: min(100%, var(--content-max));
	margin: 10px auto; /* slightly reduce outer margins to make chat denser */
	padding: 0 16px; /* align with grid rhythm */
}

/* Grouped messages (same sender) — very tight vertical spacing (nearly collapsed) */

/* Very tight spacing for grouped messages (same sender) */
.message.grouped { margin-top: 2px; margin-bottom: 2px; }
.message.grouped + .message.grouped { margin-top: 1px; }

/* Large separation when sender changes */
.message.separation { margin-top: 40px; margin-bottom: 0; }

/* Hide avatar visually but keep its layout space so bubbles align correctly */
.user-bubble-logo.avatar-hidden { visibility: hidden; opacity: 0; }

/* Removed generic non-grouped spacing to avoid overriding .separation */

/* Chat bubbles */
.message { display: flex; }
.message.left { justify-content: flex-start; align-items: flex-start; }
.message.right { justify-content: flex-end; align-items: flex-start; }

.message .user-bubble-logo {
	width: 36px;
	height: 36px;
	display: flex;
	align-items: center;
	justify-content: center;
	margin-top: 2px;
	flex-shrink: 0;
}
.message.left .user-bubble-logo { margin-right: 12px; }
.message.right .user-bubble-logo { margin-left: 12px; }
.bubble {
	max-width: 65%;
	padding: 0.75rem 1rem; /* 12px 16px */
	border-radius: 16px;
	line-height: 1.5;
	border: none;
	font-family: var(--font-ui);
	font-size: 15px;
	white-space: pre-wrap; /* respect embedded newlines and wrap long lines */
}
.message.left .bubble { /* bot */
	background: var(--bubble-bot-bg);
	color: var(--bubble-bot-text);
	border-top-left-radius: 6px;
}
.message.right .bubble { /* user */
	background: var(--bubble-user-bg);
	color: var(--bubble-user-text);
	border-top-right-radius: 6px;
}

/* Typing indicator */
.typing-bubble {
	background: var(--bubble-bot-bg);
	color: var(--bubble-bot-text);
	display: inline-flex;
	align-items: center;
	gap: 6px;
}
.typing-dots { display: inline-flex; gap: 4px; }
.typing-dots .dot {
	width: 6px; height: 6px; border-radius: 50%;
	background: var(--text-secondary);
	opacity: 0.6;
	animation: typing-blink 1.2s infinite ease-in-out;
}
.typing-dots .dot:nth-child(2) { animation-delay: 0.2s; }
.typing-dots .dot:nth-child(3) { animation-delay: 0.4s; }
@keyframes typing-blink {
	0% { opacity: 0.2; transform: translateY(0); }
	50% { opacity: 1; transform: translateY(-2px); }
	100% { opacity: 0.2; transform: translateY(0); }
}

/* Input bar */
.input-bar {
	position: fixed;
	left: 0; right: 0;
	bottom: 0;
	padding: 12px 16px; /* horizontal padding that we will "lose" when sidebar opens */
	background: transparent;
	z-index: 25;
	transition: padding 200ms ease, margin-left 240ms ease;
}
.input-bar form {
	display: grid;
	grid-template-columns: 1fr auto;
	gap: 8px;
	/* Input box color */
	background: var(--input-bg);
	padding: 0.75rem 1rem; /* 12px 16px */
	border: 1px solid var(--input-border);
	border-radius: var(--radius);
	/* make the input area narrower horizontally */
	width: min(100%, var(--content-max));
	margin: 0 auto 1rem; /* leave 1rem gap from bottom */
	min-height: 50px;
}
.input-bar input[type="text"] {
	width: 100%;
	background: transparent;
	border: none;
	outline: none;
	color: var(--text);
	font-size: 14px;
	font-weight: 500;
	font-family: var(--font-ui);
}
.send-btn {
	background: var(--accent-primary);
	color: white;
	border: 0;
	padding: 10px 14px;
	border-radius: 10px;
	cursor: pointer;
	font-family: var(--font-ui);
	font-weight: 500;
	font-size: 14px;
}
.send-btn:hover { background: var(--accent-primary-hover); }

/* Timestamps or secondary text */
.timestamp { color: var(--text-secondary); font-size: 12px; }

/* When sidebar is open, push content and input to the right, and remove input padding so it fits */
body.sidebar-open .content { left: var(--sidebar-width); }
body.sidebar-open .input-bar { margin-left: var(--sidebar-width); padding-left: 0; padding-right: 0; }

/* Small screens: narrower sidebar */
@media (max-width: 480px) {
	:root { --sidebar-width: 80vw; }
}

